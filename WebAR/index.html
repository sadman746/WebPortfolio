<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Three.js Model Viewer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128/examples/js/loaders/GLTFLoader.js"></script>
    <link rel="stylesheet" href="styles.css">
    <script src="script.js" defer></script>
</head>
<body>
    <div id="loading-screen">
        <p class="instructions">
            Attendi il caricamento del modello 3D.
        </p>
        <button id="start-ar">Avvia Visualizzazione</button>
        <div id="animation-container" style="display: none;">
            <div class="fade-animation">Caricamento...</div>
        </div>
    </div>
    
    <div id="three-container"></div>
    <button id="home-button" style="display: none;">Torna alla Home</button>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const loadingScreen = document.getElementById("loading-screen");
            const startButton = document.getElementById("start-ar");
            const homeButton = document.getElementById("home-button");
            const container = document.getElementById("three-container");
            
            startButton.addEventListener("click", () => {
                loadingScreen.style.display = "none";
                homeButton.style.display = "block";
                initThreeJS();
            });
            
            homeButton.addEventListener("click", () => {
                window.location.href = "/";
            });
        });

        function initThreeJS() {
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.getElementById("three-container").appendChild(renderer.domElement);

            const light = new THREE.HemisphereLight(0xffffff, 0x444444, 1);
            scene.add(light);

            const loader = new THREE.GLTFLoader();
            loader.load('https://res.cloudinary.com/dwcqqyaym/image/upload/v1742486706/prova_limite_vesuvioO_1_cm_u5gyo2.glb', function (gltf) {
                const model = gltf.scene;
                model.position.set(0, 0, 0);
                model.scale.set(1, 1, 1);
                scene.add(model);
            }, undefined, function (error) {
                console.error('Errore nel caricamento del modello:', error);
            });

            camera.position.set(0, 2, 5);

            function animate() {
                requestAnimationFrame(animate);
                renderer.render(scene, camera);
            }
            animate();

            window.addEventListener("resize", () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            });
        }
    </script>
</body>
</html>